{% extends 'flask/base.html' %}


{% block extrahead %}
<script>
    $(function () {
        ko.applyBindings(new GroupCollection());
    });
</script>
{% endblock %}

{% block content %}
<button class="btn" data-bind="click: toggleForm">Add Group</button>
<form class="popup wide" method="post" data-bind="visible: formVisible, submit: addGroup">
<fieldset>
<legend>Create Project Group</legend>
<div class="alert-message error" data-bind="text: errors, visible: errors"></div>
<div class="clearfix">
    <label for="id_name">Name:</label>
    <div class="input">
        <input id="id_name" type="text" name="name" maxlength="25" data-bind="value: newName"/>
    </div>
</div>

<div class="clearfix">
    <label for="id_description">Description:</label>
    <div class="input">
        <textarea id="id_description" rows="5" cols="40" name="description" data-bind="value: newDescription"></textarea>
    </div>
</div>


<div class="actions">
    <input type='submit' class='btn primary' value='Create Project Group' />
    <a data-bind="click: resetForm">Cancel</a>
</div>
</fieldset>

</form>

{% if user %}
<h2>Your Groups</h2>
<img src="{{ url_for('static', filename='cannula/img/ajax-loader.gif') }}" data-bind="visible: working"/>
<div class="groups" data-bind="foreach: items">
    <div class="group">
        <h3><a data-bind="text: title, attr: { href: absolute_url }"></a></h3>
        <p data-bind="text: description"></p>
        <div class="tools">
            <a class="delete" data-bind="click: toggleForm">Delete Group</a>
        </div>
        <p class="alert-message block-message error" data-bind="visible: formVisible">
            Are you sure you want to delete this group?<br />
            <button class="btn error" data-bind="click: deleteObject">Delete Group</button>
            <button class="btn" data-bind="click: toggleForm">Cancel</button>
        </p>
    </div>
</div>
{% endif %}

{% endblock %}
